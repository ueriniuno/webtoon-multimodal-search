import json
import re
import os

# 1. 입력 데이터
data = [
    {
        "event": "(1~4화): 조이와의 만남과 이직 스터디 제안 - 맥스는 새로운 워크스페이스에서 활발한 조이를 만나 당황한다. 조이는 맥스에게 살갑게 대하며 안대 링크를 공유해달라고 요청하고, 맥스는 혼란스러워한다. 조이는 동료들에게 뛰어난 업무 능력과 사교성으로 칭찬을 받지만, 맥스는 조이가 구직 사이트를 보고 이직 준비 중이라는 사실을 알게 된다. 옥상에서 박도율은 조이에게 배포 건을 부탁하고, 에너지 드링크를 건네며 압박한다. 버스 정류장에서 맥스는 조이에게 자신의 노트북 화면을 봤는지 묻고, 조이는 당황한다. 이후 조이는 맥스에게 이직 스터디를 제안하고, 맥스는 고민에 빠진다. 팀장 도날드는 맥스에게 업무를 떠넘기려 하고, 법인카드를 주며 조이와 함께 점심을 먹으라고 제안한다. 맥스는 조이와 고깃집에서 만나 이직 스터디에 대한 이야기를 나누고, 조이는 맥스의 장점을 칭찬하며 함께 스터디를 하고 싶은 이유를 밝힌다."
    },
    {
        "event": "(5~11화): 이직 스터디 시작과 에스더 퇴사 소동 - 맥스는 조이의 이직 스터디 제안에 고민하지만, 결국 함께하기로 결정한다. 조이는 맥스에게 유니콘 기업으로 이직하고 싶다고 말하고, 맥스는 어떤 회사와 어울릴지 고민한다. 에스더가 나타나 스터디에 참여하고 싶다고 말하고, 맥스는 당황한다. 에스더는 맥스에게 조이에게 관심있는 것 아니냐며 놀리고, 홍삼 캔디를 건넨다. 조이는 맥스에게 평일 퇴근 후 주 2회 스터디를 제안하고, 장소는 정자역으로 합의한다. 채린은 맥스의 본명이 '강동구'라는 사실을 알고 놀라워하고, 스터디 얘기를 개인 메신저로 하자고 제안하며 번호를 교환한다. 맥스는 채린의 SNS를 염탐하고, 그녀에게서 연락이 올 것을 예상하며 초조해한다. 맥스는 비상 계단에서 에스더와 사업개발팀 기획자가 싸우는 장면을 목격하고 충격에 빠진다. 에스더는 맥스에게 자신의 흑역사를 목격한 사람이 맥스여서 오히려 좋다고 말하며, 과거 남자친구에게 상처받았던 일을 고백한다. 에스더는 사직서를 내려 하고, 맥스는 '오지랖 금물'이라 되뇌이지만, 에스더의 퇴사를 막기 위해 조이와 함께 설득한다. 조이는 맥스에게 '타인의 선택을 책임질 것도 아닌데, 함부로 참견하는 건 무책임한 짓'이라며 자극하고, 맥스는 에스더에게 퇴사하지 말라고 설득한다. 에스더는 맥스의 진심에 감동받고, 퇴사를 다시 생각하기로 한다. 조이는 맥스에게 회식 참석 여부를 묻고, 닉네임에 '님'자를 붙이는 것에 대해 서운함을 표현한다."
    },
    {
        "event": "(12~17화): 조이에게 느끼는 감정과 거리두기 결심 - 레오는 맥스에게 팀 회식에 참여할 것을 권유하고, 회식 자리에서 레오는 조이와 맥스를 엮으려는 듯한 발언을 한다. 회식 후 조이는 맥스에게 초코우유를 받고, 에스더는 맥스에게 호감을 표현한다. 맥스는 레오에게 파견 사무실 장비들을 옮기는 것을 도와달라는 부탁을 받고, 함께 이동하며 여러 이야기를 나눈다. 레오는 맥스에게 이직 제안을 할 수도 있다고 암시하고, 맥스는 프리랜서로 활동하고 싶다는 자신의 생각을 밝힌다. 맥스는 조이를 위해 케이크를 사다주고, 조이는 맥스의 섬세함에 감동한다. 맥스는 조이에게 디카페인 커피를 마시게 하려다 실수로 일반 커피를 주고, 조이가 레오에 대한 이야기를 꺼내자 불편해한다. 그는 조이가 자신을 놀리는 것 같아 더욱 불편해한다. 조이는 동구에게 섬세하지만 겉으로 드러내지 않는, 내면이 단단한 사람이 더 좋다고 말한다. 채린은 동구에게 소개팅은 거절했는지 묻고, 사내 연애에 대한 생각을 묻는다. 동구는 채린의 잦은 질문에 당황스러워한다. 조이가 감기 기운으로 아파하자, 맥스는 걱정하며 조퇴를 권유한다. 맥스는 조이를 대신해 야근을 하고, 조이에게 호감을 느끼는 자신을 발견한다. 조이는 앤디에게 주말 생일 쿠폰을 받았다고 말하고, 맥스는 자신이 조이의 어장에 빠져들고 있음을 자각한다. 맥스는 조이와 엮인 환경을 개선해야 한다고 결심하고, 조이에게 거리를 두기로 한다. 조이가 저녁 식사를 제안하지만, 가족 약속이 있다는 거짓말을 하고, 조이는 당황한 표정을 짓는다."
    }
]

# 2. 저장할 폴더 생성
output_dir = "events_json_output"
os.makedirs(output_dir, exist_ok=True)

# 3. 파싱 및 JSON 파일 저장
pattern = r"\((.*?)\):\s*(.*?)\s*-\s*(.*)"

for idx, item in enumerate(data, 1):
    match = re.search(pattern, item["event"])
    if match:
        raw_range = match.group(1) # "1~4화"
        title = match.group(2)     # 제목
        content = match.group(3)   # 내용
        
        # 파일명 생성을 위한 숫자 추출
        nums = re.findall(r'\d+', raw_range)
        
        if len(nums) >= 2:
            filename = f"event{idx}_{nums[0]}_{nums[1]}.json"
        else:
            filename = f"event{idx}_{nums[0]}.json"
            
        file_path = os.path.join(output_dir, filename)
        
        # JSON 구조 생성
        json_content = {
            "episode_range": raw_range,
            "title": title,
            "content": content
        }
        
        # JSON 파일 쓰기
        with open(file_path, "w", encoding="utf-8") as f:
            json.dump(json_content, f, ensure_ascii=False, indent=4)
            
        print(f"생성 완료: {filename}")

print("\n모든 JSON 파일 저장이 완료되었습니다.")